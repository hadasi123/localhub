{"ast":null,"code":"// News service for LocalHub - Data Layer\nimport{createNewsData}from'../types';// News service class\nclass NewsService{constructor(){this.cache=null;this.cacheExpiry=15*60*1000;// 15 minutes\nthis.apiUrl='https://newsapi.org/v2/everything';this.apiKey='f3c8e34982b44a50b0ee3409654bce56';}// Get news articles from NewsAPI\nasync getNews(){try{// Check cache first\nif(this.cache&&this.isCacheValid()){return this.cache;}// Fetch news data from NewsAPI\nconst newsData=await this.fetchNewsFromAPI();// Cache the result\nthis.cache=newsData;this.cacheTimestamp=Date.now();return newsData;}catch(error){console.error('Error fetching news data:',error);// Return fallback data if API fails\nreturn this.getFallbackNewsData();}}// Fetch news data from NewsAPI\nasync fetchNewsFromAPI(){const params=new URLSearchParams({q:'news',language:'he',apiKey:this.apiKey,pageSize:10,sortBy:'publishedAt'});const response=await fetch(\"\".concat(this.apiUrl,\"?\").concat(params));if(!response.ok){throw new Error(\"News API error: \".concat(response.status));}const data=await response.json();if(data.status!=='ok'){throw new Error('News API returned error status');}// Transform API response to our format\nconst articles=data.articles.map(article=>createNewsData({id:this.generateId(article.url),title:article.title,description:article.description,url:article.url,imageUrl:article.urlToImage,source:article.source.name,author:article.author,publishedAt:article.publishedAt,content:article.content}));return{articles,totalResults:data.totalResults,timestamp:new Date().toISOString()};}// Generate a simple ID from URL\ngenerateId(url){return url.split('/').pop().replace(/[^a-zA-Z0-9]/g,'');}// Fallback news data if API fails\ngetFallbackNewsData(){return{articles:[createNewsData({id:'fallback-1',title:'חדשות מקומיות',description:'עדכונים מהקהילה המקומית',url:'#',imageUrl:'',source:'LocalHub',author:'מערכת',publishedAt:new Date().toISOString(),content:'חדשות מקומיות זמינות בקרוב'})],totalResults:1,timestamp:new Date().toISOString()};}// Check if cache is still valid\nisCacheValid(){return this.cacheTimestamp&&Date.now()-this.cacheTimestamp<this.cacheExpiry;}// Format date for display\nformatDate(dateString){const date=new Date(dateString);const now=new Date();const diffInHours=Math.floor((now-date)/(1000*60*60));if(diffInHours<1){return'לפני פחות משעה';}else if(diffInHours<24){return\"\\u05DC\\u05E4\\u05E0\\u05D9 \".concat(diffInHours,\" \\u05E9\\u05E2\\u05D5\\u05EA\");}else{const diffInDays=Math.floor(diffInHours/24);return\"\\u05DC\\u05E4\\u05E0\\u05D9 \".concat(diffInDays,\" \\u05D9\\u05DE\\u05D9\\u05DD\");}}// Truncate text for display\ntruncateText(text){let maxLength=arguments.length>1&&arguments[1]!==undefined?arguments[1]:150;if(!text)return'';if(text.length<=maxLength)return text;return text.substring(0,maxLength)+'...';}}// Create singleton instance\nconst newsService=new NewsService();export default newsService;","map":{"version":3,"names":["createNewsData","NewsService","constructor","cache","cacheExpiry","apiUrl","apiKey","getNews","isCacheValid","newsData","fetchNewsFromAPI","cacheTimestamp","Date","now","error","console","getFallbackNewsData","params","URLSearchParams","q","language","pageSize","sortBy","response","fetch","concat","ok","Error","status","data","json","articles","map","article","id","generateId","url","title","description","imageUrl","urlToImage","source","name","author","publishedAt","content","totalResults","timestamp","toISOString","split","pop","replace","formatDate","dateString","date","diffInHours","Math","floor","diffInDays","truncateText","text","maxLength","arguments","length","undefined","substring","newsService"],"sources":["/Users/hadascohen/experiments/localhub/src/services/newsService.js"],"sourcesContent":["// News service for LocalHub - Data Layer\n\nimport { createNewsData } from '../types';\n\n// News service class\nclass NewsService {\n  constructor() {\n    this.cache = null;\n    this.cacheExpiry = 15 * 60 * 1000; // 15 minutes\n    this.apiUrl = 'https://newsapi.org/v2/everything';\n    this.apiKey = 'f3c8e34982b44a50b0ee3409654bce56';\n  }\n\n  // Get news articles from NewsAPI\n  async getNews() {\n    try {\n      // Check cache first\n      if (this.cache && this.isCacheValid()) {\n        return this.cache;\n      }\n\n      // Fetch news data from NewsAPI\n      const newsData = await this.fetchNewsFromAPI();\n      \n      // Cache the result\n      this.cache = newsData;\n      this.cacheTimestamp = Date.now();\n      \n      return newsData;\n    } catch (error) {\n      console.error('Error fetching news data:', error);\n      // Return fallback data if API fails\n      return this.getFallbackNewsData();\n    }\n  }\n\n  // Fetch news data from NewsAPI\n  async fetchNewsFromAPI() {\n    const params = new URLSearchParams({\n      q: 'news',\n      language: 'he',\n      apiKey: this.apiKey,\n      pageSize: 10,\n      sortBy: 'publishedAt'\n    });\n\n    const response = await fetch(`${this.apiUrl}?${params}`);\n    \n    if (!response.ok) {\n      throw new Error(`News API error: ${response.status}`);\n    }\n\n    const data = await response.json();\n    \n    if (data.status !== 'ok') {\n      throw new Error('News API returned error status');\n    }\n\n    // Transform API response to our format\n    const articles = data.articles.map(article => \n      createNewsData({\n        id: this.generateId(article.url),\n        title: article.title,\n        description: article.description,\n        url: article.url,\n        imageUrl: article.urlToImage,\n        source: article.source.name,\n        author: article.author,\n        publishedAt: article.publishedAt,\n        content: article.content\n      })\n    );\n\n    return {\n      articles,\n      totalResults: data.totalResults,\n      timestamp: new Date().toISOString()\n    };\n  }\n\n  // Generate a simple ID from URL\n  generateId(url) {\n    return url.split('/').pop().replace(/[^a-zA-Z0-9]/g, '');\n  }\n\n  // Fallback news data if API fails\n  getFallbackNewsData() {\n    return {\n      articles: [\n        createNewsData({\n          id: 'fallback-1',\n          title: 'חדשות מקומיות',\n          description: 'עדכונים מהקהילה המקומית',\n          url: '#',\n          imageUrl: '',\n          source: 'LocalHub',\n          author: 'מערכת',\n          publishedAt: new Date().toISOString(),\n          content: 'חדשות מקומיות זמינות בקרוב'\n        })\n      ],\n      totalResults: 1,\n      timestamp: new Date().toISOString()\n    };\n  }\n\n  // Check if cache is still valid\n  isCacheValid() {\n    return this.cacheTimestamp && \n           (Date.now() - this.cacheTimestamp) < this.cacheExpiry;\n  }\n\n  // Format date for display\n  formatDate(dateString) {\n    const date = new Date(dateString);\n    const now = new Date();\n    const diffInHours = Math.floor((now - date) / (1000 * 60 * 60));\n    \n    if (diffInHours < 1) {\n      return 'לפני פחות משעה';\n    } else if (diffInHours < 24) {\n      return `לפני ${diffInHours} שעות`;\n    } else {\n      const diffInDays = Math.floor(diffInHours / 24);\n      return `לפני ${diffInDays} ימים`;\n    }\n  }\n\n  // Truncate text for display\n  truncateText(text, maxLength = 150) {\n    if (!text) return '';\n    if (text.length <= maxLength) return text;\n    return text.substring(0, maxLength) + '...';\n  }\n}\n\n// Create singleton instance\nconst newsService = new NewsService();\n\nexport default newsService;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}