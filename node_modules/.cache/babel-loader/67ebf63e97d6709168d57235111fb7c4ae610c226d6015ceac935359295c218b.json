{"ast":null,"code":"// News service for LocalHub - Data Layer\n\nimport { createNewsData } from '../types';\n\n// News service class\nclass NewsService {\n  constructor() {\n    this.cache = null;\n    this.cacheExpiry = 15 * 60 * 1000; // 15 minutes\n    this.apiUrl = 'https://newsapi.org/v2/everything';\n    this.apiKey = 'f3c8e34982b44a50b0ee3409654bce56';\n  }\n\n  // Get news articles from NewsAPI\n  async getNews() {\n    try {\n      // Check cache first\n      if (this.cache && this.isCacheValid()) {\n        return this.cache;\n      }\n\n      // Fetch news data from NewsAPI\n      const newsData = await this.fetchNewsFromAPI();\n\n      // Cache the result\n      this.cache = newsData;\n      this.cacheTimestamp = Date.now();\n      return newsData;\n    } catch (error) {\n      console.error('Error fetching news data:', error);\n      // Return fallback data if API fails\n      return this.getFallbackNewsData();\n    }\n  }\n\n  // Fetch news data from NewsAPI\n  async fetchNewsFromAPI() {\n    const params = new URLSearchParams({\n      q: 'news',\n      language: 'he',\n      apiKey: this.apiKey,\n      pageSize: 10,\n      sortBy: 'publishedAt'\n    });\n    const response = await fetch(`${this.apiUrl}?${params}`);\n    if (!response.ok) {\n      throw new Error(`News API error: ${response.status}`);\n    }\n    const data = await response.json();\n    if (data.status !== 'ok') {\n      throw new Error('News API returned error status');\n    }\n\n    // Transform API response to our format\n    const articles = data.articles.map(article => createNewsData({\n      id: this.generateId(article.url),\n      title: article.title,\n      description: article.description,\n      url: article.url,\n      imageUrl: article.urlToImage,\n      source: article.source.name,\n      author: article.author,\n      publishedAt: article.publishedAt,\n      content: article.content\n    }));\n    return {\n      articles,\n      totalResults: data.totalResults,\n      timestamp: new Date().toISOString()\n    };\n  }\n\n  // Generate a simple ID from URL\n  generateId(url) {\n    return url.split('/').pop().replace(/[^a-zA-Z0-9]/g, '');\n  }\n\n  // Fallback news data if API fails\n  getFallbackNewsData() {\n    return {\n      articles: [createNewsData({\n        id: 'fallback-1',\n        title: 'חדשות מקומיות',\n        description: 'עדכונים מהקהילה המקומית',\n        url: '#',\n        imageUrl: '',\n        source: 'LocalHub',\n        author: 'מערכת',\n        publishedAt: new Date().toISOString(),\n        content: 'חדשות מקומיות זמינות בקרוב'\n      })],\n      totalResults: 1,\n      timestamp: new Date().toISOString()\n    };\n  }\n\n  // Check if cache is still valid\n  isCacheValid() {\n    return this.cacheTimestamp && Date.now() - this.cacheTimestamp < this.cacheExpiry;\n  }\n\n  // Format date for display\n  formatDate(dateString) {\n    const date = new Date(dateString);\n    const now = new Date();\n    const diffInHours = Math.floor((now - date) / (1000 * 60 * 60));\n    if (diffInHours < 1) {\n      return 'לפני פחות משעה';\n    } else if (diffInHours < 24) {\n      return `לפני ${diffInHours} שעות`;\n    } else {\n      const diffInDays = Math.floor(diffInHours / 24);\n      return `לפני ${diffInDays} ימים`;\n    }\n  }\n\n  // Truncate text for display\n  truncateText(text, maxLength = 150) {\n    if (!text) return '';\n    if (text.length <= maxLength) return text;\n    return text.substring(0, maxLength) + '...';\n  }\n}\n\n// Create singleton instance\nconst newsService = new NewsService();\nexport default newsService;","map":{"version":3,"names":["createNewsData","NewsService","constructor","cache","cacheExpiry","apiUrl","apiKey","getNews","isCacheValid","newsData","fetchNewsFromAPI","cacheTimestamp","Date","now","error","console","getFallbackNewsData","params","URLSearchParams","q","language","pageSize","sortBy","response","fetch","ok","Error","status","data","json","articles","map","article","id","generateId","url","title","description","imageUrl","urlToImage","source","name","author","publishedAt","content","totalResults","timestamp","toISOString","split","pop","replace","formatDate","dateString","date","diffInHours","Math","floor","diffInDays","truncateText","text","maxLength","length","substring","newsService"],"sources":["/Users/hadascohen/experiments/localhub/src/services/newsService.js"],"sourcesContent":["// News service for LocalHub - Data Layer\n\nimport { createNewsData } from '../types';\n\n// News service class\nclass NewsService {\n  constructor() {\n    this.cache = null;\n    this.cacheExpiry = 15 * 60 * 1000; // 15 minutes\n    this.apiUrl = 'https://newsapi.org/v2/everything';\n    this.apiKey = 'f3c8e34982b44a50b0ee3409654bce56';\n  }\n\n  // Get news articles from NewsAPI\n  async getNews() {\n    try {\n      // Check cache first\n      if (this.cache && this.isCacheValid()) {\n        return this.cache;\n      }\n\n      // Fetch news data from NewsAPI\n      const newsData = await this.fetchNewsFromAPI();\n      \n      // Cache the result\n      this.cache = newsData;\n      this.cacheTimestamp = Date.now();\n      \n      return newsData;\n    } catch (error) {\n      console.error('Error fetching news data:', error);\n      // Return fallback data if API fails\n      return this.getFallbackNewsData();\n    }\n  }\n\n  // Fetch news data from NewsAPI\n  async fetchNewsFromAPI() {\n    const params = new URLSearchParams({\n      q: 'news',\n      language: 'he',\n      apiKey: this.apiKey,\n      pageSize: 10,\n      sortBy: 'publishedAt'\n    });\n\n    const response = await fetch(`${this.apiUrl}?${params}`);\n    \n    if (!response.ok) {\n      throw new Error(`News API error: ${response.status}`);\n    }\n\n    const data = await response.json();\n    \n    if (data.status !== 'ok') {\n      throw new Error('News API returned error status');\n    }\n\n    // Transform API response to our format\n    const articles = data.articles.map(article => \n      createNewsData({\n        id: this.generateId(article.url),\n        title: article.title,\n        description: article.description,\n        url: article.url,\n        imageUrl: article.urlToImage,\n        source: article.source.name,\n        author: article.author,\n        publishedAt: article.publishedAt,\n        content: article.content\n      })\n    );\n\n    return {\n      articles,\n      totalResults: data.totalResults,\n      timestamp: new Date().toISOString()\n    };\n  }\n\n  // Generate a simple ID from URL\n  generateId(url) {\n    return url.split('/').pop().replace(/[^a-zA-Z0-9]/g, '');\n  }\n\n  // Fallback news data if API fails\n  getFallbackNewsData() {\n    return {\n      articles: [\n        createNewsData({\n          id: 'fallback-1',\n          title: 'חדשות מקומיות',\n          description: 'עדכונים מהקהילה המקומית',\n          url: '#',\n          imageUrl: '',\n          source: 'LocalHub',\n          author: 'מערכת',\n          publishedAt: new Date().toISOString(),\n          content: 'חדשות מקומיות זמינות בקרוב'\n        })\n      ],\n      totalResults: 1,\n      timestamp: new Date().toISOString()\n    };\n  }\n\n  // Check if cache is still valid\n  isCacheValid() {\n    return this.cacheTimestamp && \n           (Date.now() - this.cacheTimestamp) < this.cacheExpiry;\n  }\n\n  // Format date for display\n  formatDate(dateString) {\n    const date = new Date(dateString);\n    const now = new Date();\n    const diffInHours = Math.floor((now - date) / (1000 * 60 * 60));\n    \n    if (diffInHours < 1) {\n      return 'לפני פחות משעה';\n    } else if (diffInHours < 24) {\n      return `לפני ${diffInHours} שעות`;\n    } else {\n      const diffInDays = Math.floor(diffInHours / 24);\n      return `לפני ${diffInDays} ימים`;\n    }\n  }\n\n  // Truncate text for display\n  truncateText(text, maxLength = 150) {\n    if (!text) return '';\n    if (text.length <= maxLength) return text;\n    return text.substring(0, maxLength) + '...';\n  }\n}\n\n// Create singleton instance\nconst newsService = new NewsService();\n\nexport default newsService;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}